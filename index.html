<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>LWR · 生日庆典</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600&family=Marcellus&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #f5e3b8;
      --accent: #f7c76b;
      --accent-soft: rgba(247, 199, 107, 0.4);
      --bg-deep: #070c1d;
      --bg-card: rgba(18, 25, 53, 0.9);
      --border-gold: #d9b875;
      --text-main: #fefaf2;
      --text-soft: #e9dcbe;
      --text-muted: #b8bfdc;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      font-family: "Noto Serif SC", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1b2752 0%, #050815 55%, #02030a 100%);
      color: var(--text-main);
      overflow-x: hidden;
    }

    .scene {
      position: relative;
      min-height: 100vh;
      padding: 32px 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .container {
      max-width: 660px;
      width: 100%;
      position: relative;
      z-index: 1;
    }

    .title-block {
      text-align: center;
      margin-bottom: 24px;
    }

    .title-main {
      font-family: "Marcellus", "Noto Serif SC", serif;
      font-size: clamp(26px, 4vw, 32px);
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--primary);
      text-shadow: 0 0 14px rgba(245, 227, 184, 0.6);
    }

    .title-sub {
      margin-top: 8px;
      font-size: 16px;
      color: var(--text-muted);
    }

    .stage {
      display: flex;
      flex-direction: column;
      gap: 32px;
      align-items: center;
      justify-content: center;
      padding: 24px;
      border-radius: 28px;
      background: linear-gradient(135deg, rgba(11, 17, 43, 0.94), rgba(31, 43, 92, 0.94));
      box-shadow:
        0 0 30px rgba(0, 0, 0, 0.8),
        0 0 40px rgba(153, 189, 255, 0.4);
      border: 1px solid rgba(189, 206, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    /* 蛋糕区域（无上下跳动） */
    .cake-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      animation: fadeIn 2s ease-out;
    }

    .cake-base {
      position: relative;
      width: min(260px, 70vw);
      height: 200px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      perspective: 900px;
    }

    .cake-plate {
      position: absolute;
      bottom: 8px;
      width: 90%;
      height: 22px;
      background: radial-gradient(circle at 50% 0, #ffffff 0, #d1d7ff 40%, #8e99d8 100%);
      border-radius: 50%;
      box-shadow:
        0 14px 20px rgba(0, 0, 0, 0.65),
        0 0 18px rgba(180, 199, 255, 0.7);
    }

    .cake-body {
      position: relative;
      width: 72%;
      height: 120px;
      border-radius: 24px 24px 18px 18px;
      background: linear-gradient(180deg, #ffe0e9 0%, #fbb9c8 45%, #f19aa8 100%);
      box-shadow:
        0 8px 16px rgba(0, 0, 0, 0.5),
        0 0 20px rgba(255, 178, 200, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.7);
      transform-origin: center bottom;
      transform: translateY(-10px);
      animation: cakeAnimation 2s ease-out infinite alternate;
      will-change: transform;
    }

    .cake-body::before {
      content: "";
      position: absolute;
      top: -18px;
      left: 8%;
      right: 8%;
      height: 26px;
      background-image:
        radial-gradient(circle at 10% 90%, #fffaf4 0, transparent 55%),
        radial-gradient(circle at 50% 90%, #fffaf4 0, transparent 55%),
        radial-gradient(circle at 90% 90%, #fffaf4 0, transparent 55%);
    }

    /* 蛋糕上的简洁鹿头图案 */
    .cake-deer-icon {
      position: absolute;
      bottom: 32px;              /* 控制鹿头在蛋糕上的高度，可以按喜好微调 */
      left: 50%;
      transform: translateX(-50%);
      width: 70px;
      height: 54px;
      pointer-events: none;
    }

    /* 脸的主形状：略微偏扁的圆角矩形 */
    .deer-face {
      position: absolute;
      inset: 0;
      margin: auto;
      width: 70px;
      height: 50px;
      border-radius: 26px;
      background: radial-gradient(circle at 30% 20%, #ffe8c9 0, #f3c38a 40%, #e29d5e 100%);
      box-shadow: 0 0 8px rgba(189, 120, 63, 0.55);
    }

    /* 耳朵：简单的小椭圆 */
    .deer-ear-simple {
      position: absolute;
      width: 18px;
      height: 22px;
      border-radius: 60% 60% 40% 40%;
      background: linear-gradient(135deg, #fce3c5, #e3ad74);
    }

    .deer-ear-simple--left {
      top: -10px;
      left: 4px;
      transform: rotate(-10deg);
    }

    .deer-ear-simple--right {
      top: -10px;
      right: 4px;
      transform: rotate(10deg);
    }

    /* 鹿角：非常简化的两个小叉形轮廓 */
    .deer-antler {
      position: absolute;
      width: 3px;
      height: 16px;
      background: #c28546;
      border-radius: 999px;
    }

    .deer-antler::before,
    .deer-antler::after {
      content: "";
      position: absolute;
      width: 3px;
      height: 8px;
      background: #c28546;
      border-radius: 999px;
    }

    .deer-antler--left {
      top: -18px;
      left: 18px;
    }

    .deer-antler--left::before {
      top: 3px;
      left: -5px;
      transform: rotate(-25deg);
    }

    .deer-antler--left::after {
      top: 6px;
      left: 4px;
      transform: rotate(20deg);
    }

    .deer-antler--right {
      top: -18px;
      right: 18px;
    }

    .deer-antler--right::before {
      top: 3px;
      right: -5px;
      transform: rotate(25deg);
    }

    .deer-antler--right::after {
      top: 6px;
      right: 4px;
      transform: rotate(-20deg);
    }

    /* 眼睛：小圆点 */
    .deer-eye-simple {
      position: absolute;
      top: 20px;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #4a2f25;
      box-shadow: 0 0 4px rgba(74, 47, 37, 0.6);
    }

    .deer-eye-simple--left {
      left: 20px;
    }

    .deer-eye-simple--right {
      right: 20px;
    }

    /* 鼻子：小椭圆 */
    .deer-nose-simple {
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 14px;
      height: 9px;
      border-radius: 999px;
      background: #4f3030;
    }

    /* 淡淡腮红 */
    .deer-cheek-simple {
      position: absolute;
      top: 26px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ffe7ee 0, #f7a9bb 55%, rgba(255, 255, 255, 0) 100%);
      opacity: 0.9;
    }

    .deer-cheek-simple--left {
      left: 11px;
    }

    .deer-cheek-simple--right {
      right: 11px;
    }



    .cake-decoration-dots {
      position: absolute;
      bottom: 18px;
      left: 10%;
      right: 10%;
      display: flex;
      justify-content: space-between;
    }

    .cake-decoration-dots span {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #ffffff 0, #ffe6c5 40%, #f1b05a 100%);
      box-shadow: 0 0 6px rgba(255, 210, 140, 0.8);
      animation: sparkleAnimation 1s ease-in-out infinite alternate;
    }

    .cake-candle {
      position: absolute;
      top: -42px;
      left: 50%;
      transform: translateX(-50%);
      width: 16px;
      height: 38px;
      border-radius: 8px;
      background: repeating-linear-gradient(
        135deg,
        #f9f1ff,
        #f9f1ff 6px,
        #ddb6ff 6px,
        #ddb6ff 12px
      );
      box-shadow: 0 0 8px rgba(236, 210, 255, 0.9);
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }

    .candle-flame {
      width: 18px;
      height: 28px;
      border-radius: 50% 50% 50% 50%;
      background: radial-gradient(circle at 50% 20%, #ffffff 0, #ffe29f 40%, #ff8c42 70%, rgba(255, 255, 255, 0) 100%);
      margin-top: -24px;
      box-shadow:
        0 0 16px rgba(255, 204, 128, 0.9),
        0 0 28px rgba(255, 227, 168, 0.9);
      animation: flameFlicker 1.8s ease-in-out infinite;
      transform-origin: bottom center;
      will-change: transform, opacity;
    }

    @keyframes flameFlicker {
      0% { transform: translateX(0) scale(1); opacity: 1; }
      40% { transform: translateX(-1px) scale(0.96); opacity: 0.9; }
      70% { transform: translateX(1px) scale(1.03); opacity: 1; }
      100% { transform: translateX(0.5px) scale(0.98); opacity: 0.92; }
    }

    @keyframes sparkleAnimation {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.5; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes cakeAnimation {
      0%, 100% { transform: translateY(-10px); }
      50% { transform: translateY(-12px); } /* 微小浮动，不是跳动 */
    }

    .cake-caption {
      font-size: 14px;
      color: var(--text-soft);
      text-align: center;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      opacity: 0.9;
    }

    /* 信封区域 */
    .envelope-area {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      text-align: center;
      animation: fadeIn 2s ease-out;
    }

    .envelope-hint {
      font-size: 13px;
      color: var(--text-soft);
      opacity: 0.95;
    }

    .envelope-button {
      position: relative;
      margin-top: 10px;
      width: min(260px, 70vw);
      height: 170px;
      border: none;
      background: transparent;
      cursor: pointer;
      outline: none;
      transform-origin: center center;
      transition: transform 0.25s ease, filter 0.25s ease;
    }

    .envelope-button:hover {
      transform: translateY(-4px) scale(1.03);
      filter: drop-shadow(0 0 18px rgba(249, 218, 149, 0.9));
    }

    .envelope-glow {
      position: absolute;
      inset: -18px;
      border-radius: 24px;
      background: radial-gradient(circle at 50% 0%, rgba(255, 243, 195, 0.25), transparent 60%);
      opacity: 0.9;
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .envelope-card {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .envelope-back {
      position: absolute;
      inset: 0;
      border-radius: 20px;
      background: linear-gradient(145deg, #fdf7e8, #f4e0b7);
      box-shadow:
        0 12px 20px rgba(0, 0, 0, 0.6),
        0 0 22px rgba(245, 222, 170, 0.95);
      border: 1px solid rgba(233, 198, 132, 0.9);
    }

    .envelope-front {
      position: absolute;
      inset: 22px 18px 18px;
      border-radius: 14px;
      background: linear-gradient(135deg, #fefcf7, #f7ebcf);
      overflow: hidden;
    }

    .envelope-front::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(135deg, rgba(246, 220, 152, 0.5), transparent 55%),
        linear-gradient(225deg, rgba(246, 220, 152, 0.5), transparent 55%);
      clip-path: polygon(0 0, 50% 55%, 100% 0);
      opacity: 0.9;
    }

    .envelope-seal {
      position: absolute;
      top: 24px;
      left: 50%;
      transform: translateX(-50%);
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff2d5 0, #f3b96b 40%, #d78136 100%);
      box-shadow:
        0 0 14px rgba(243, 192, 118, 0.9),
        0 0 24px rgba(243, 192, 118, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #5b3213;
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 0.06em;
    }

    .envelope-label {
      position: absolute;
      bottom: 18px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 14px;
      color: #85623a;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    .envelope-label span {
      padding: 4px 10px;
      border-radius: 999px;
      background-color: rgba(255, 249, 233, 0.9);
      border: 1px solid rgba(231, 199, 147, 0.7);
    }

    .small-note {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* 信件弹窗 */
    .letter-modal {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(0px); /* 可以顺便稍微减一点 blur，让星星更清晰 */
      background: transparent;  /* 或者直接不写 background 这一行 */
      z-index: 20;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease;
    }


    .letter-modal.show {
      opacity: 1;
      pointer-events: auto;
    }

    .letter-card {
      position: relative;
      width: min(720px, 100%);
      max-height: 80vh;
      margin: 0 16px;
      border-radius: 22px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.6) 0, transparent 45%),
        radial-gradient(circle at 100% 100%, rgba(255, 227, 179, 0.4) 0, transparent 55%),
        linear-gradient(135deg, #fffaf1, #fce8cf);
      box-shadow:
        0 22px 32px rgba(0, 0, 0, 0.85),
        0 0 34px rgba(248, 204, 140, 0.9);
      border: 1px solid rgba(219, 179, 118, 0.9);
      transform: translateY(25px) scale(0.96);
      opacity: 0;
      transition: transform 0.35s ease, opacity 0.35s ease;
      overflow: hidden;
    }

    .letter-modal.show .letter-card {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .letter-frame {
      position: absolute;
      inset: 12px;
      border-radius: 18px;
      border: 1px dashed rgba(198, 157, 93, 0.7);
      pointer-events: none;
    }

    .letter-inner {
      position: relative;
      padding: 22px 26px 20px;
      max-height: 80vh;
      overflow-y: auto;
      font-size: 15px;
      line-height: 1.7;
      color: #5f4930;
    }

    .letter-inner::-webkit-scrollbar {
      width: 6px;
    }
    .letter-inner::-webkit-scrollbar-track {
      background: transparent;
    }
    .letter-inner::-webkit-scrollbar-thumb {
      background: rgba(191, 157, 107, 0.7);
      border-radius: 999px;
    }

    .letter-heading {
      font-size: 16px;
      margin-bottom: 6px;
    }

    .letter-inner p {
      margin: 6px 0;
      text-indent: 2em;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    .letter-inner p.no-indent {
      text-indent: 0;
    }

    .letter-inner p.signature {
      margin-top: 12px;
      text-align: right;
      text-indent: 0;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 12px;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid rgba(158, 123, 71, 0.8);
      background: radial-gradient(circle at 30% 20%, #fffdf8 0, #f3d8ad 40%, #d7b377 100%);
      cursor: pointer;
      font-size: 18px;
      line-height: 1;
      color: #5b3b1b;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 10px rgba(248, 210, 150, 0.9);
      transition: transform 0.18s ease, box-shadow 0.18s ease;
    }

    .close-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 14px rgba(248, 210, 150, 1);
    }

    /* 魔法对话框 */
    .magic-dialog {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.6);
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.8) 0, transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(255, 225, 180, 0.7) 0, transparent 55%),
        #fffaf1;
      padding: 22px 20px 18px;
      border-radius: 18px;
      box-shadow:
        0 18px 30px rgba(0, 0, 0, 0.5),
        0 0 26px rgba(248, 204, 140, 0.9);
      border: 1px solid rgba(219, 179, 118, 0.9);
      z-index: 30;
      opacity: 0;
      transition: opacity 0.35s ease, transform 0.35s ease;
    }

    .magic-dialog.show {
      display: block;
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }

    .magic-dialog p {
      font-size: 14px;
      color: #5f4930;
      text-align: left;
      line-height: 1.7;
      margin: 4px 0;
      text-indent: 2em;
    }

    .magic-dialog .close-btn-dialog {
      margin-top: 12px;
      padding: 6px 16px;
      background-color: #f7c76b;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      font-size: 13px;
      color: #5b3213;
    }

    .magic-dialog .close-btn-dialog:hover {
      background-color: #f5e3b8;
    }

    .magic-trigger-btn {
      margin-top: 10px;
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid rgba(219,179,118,0.9);
      background: radial-gradient(circle at 20% 0, #fff9ea 0, #f5d79c 40%, #e4b867 100%);
      color: #5b3b1b;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(245, 215, 160, 0.9);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .magic-trigger-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 14px rgba(248, 220, 168, 1);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* 小星屑动画（从 JS 里挪到 CSS，更省资源） */
    @keyframes sparkleFloat {
      0% { transform: translate3d(0, 0, 0) scale(0.3); opacity: 0; }
      40% { opacity: 1; }
      100% { transform: translate3d(0, -40px, 0) scale(1); opacity: 0; }
    }

    .sparkle {
      will-change: transform, opacity;
    }

    /* 全屏烟花效果 */
    .firework {
      position: fixed;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 50;
      background: transparent;
      box-shadow:
        0 0 0 0 rgba(255, 255, 255, 1),
        20px 0 0 0 rgba(255, 180, 120, 1),
        -20px 0 0 0 rgba(180, 220, 255, 1),
        0 20px 0 0 rgba(255, 255, 180, 1),
        0 -20px 0 0 rgba(255, 200, 200, 1),
        14px 14px 0 0 rgba(255, 220, 170, 1),
        -14px 14px 0 0 rgba(200, 220, 255, 1),
        14px -14px 0 0 rgba(255, 230, 220, 1),
        -14px -14px 0 0 rgba(255, 255, 220, 1);
      animation: fireworksBurst 1.2s ease-out forwards;
      will-change: transform, opacity;
    }

    @keyframes fireworksBurst {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      60% {
        transform: scale(1.4);
        opacity: 1;
      }
      100% {
        transform: scale(1.8);
        opacity: 0;
      }
    }

        /* —— 星光背景 —— */
    .starfield {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none; /* 不挡住按钮点击 */
      z-index: 0;
    }

    /* 所有星星：静态的小光点 */
    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      border-radius: 50%;
      background: radial-gradient(
        circle at 30% 30%,
        #ffffff 0,
        rgba(255, 255, 255, 0.7) 40%,
        rgba(255, 255, 255, 0) 100%
      );
      opacity: 0.35; /* 默认微亮 */
    }

    /* 只给一部分星星加 twinkle 动画，减轻压力 */
    .star--twinkle {
      animation-name: twinkle;
      animation-iteration-count: infinite;
      animation-timing-function: ease-in-out;
      will-change: opacity, transform;
    }

    @keyframes twinkle {
      0% {
        opacity: 0.1;
        transform: scale(0.8);
      }
      40% {
        opacity: 1;
        transform: scale(1);
      }
      100% {
        opacity: 0.1;
        transform: scale(0.8);
      }
    }

  </style>
</head>
<body>
  <div class="scene">
    <!-- ★ 星光背景层 -->
    <div class="starfield" id="starfield"></div>

    <div class="container">
      <div class="title-block">
        <div class="title-main">DEAR DEER · BIRTHDAY</div>
        <div class="title-sub">隆重的生日会 · 来自JH的一封信</div>
      </div>

      <div class="stage">
        <!-- 上：生日蛋糕 -->
        <div class="stage-left">
          <div class="cake-area">
            <div class="cake-base">
              <div class="cake-plate"></div>
              <div class="cake-body">
                <!-- 简洁鹿头图案 -->
                <div class="cake-deer-icon">
                  <div class="deer-face">
                    <div class="deer-ear-simple deer-ear-simple--left"></div>
                    <div class="deer-ear-simple deer-ear-simple--right"></div>
                    <div class="deer-antler deer-antler--left"></div>
                    <div class="deer-antler deer-antler--right"></div>
                    <div class="deer-eye-simple deer-eye-simple--left"></div>
                    <div class="deer-eye-simple deer-eye-simple--right"></div>
                    <div class="deer-nose-simple"></div>
                    <div class="deer-cheek-simple deer-cheek-simple--left"></div>
                    <div class="deer-cheek-simple deer-cheek-simple--right"></div>
                  </div>
                </div>
              
                <div class="cake-candle">
                  <div class="candle-flame"></div>
                </div>
                <div class="cake-decoration-dots">
                  <span></span><span></span><span></span><span></span><span></span>
                </div>
              </div>
              
            </div>
            <div class="cake-caption">Happy Birthday · 十二月七</div>
          </div>
        </div>

        <!-- 下：信封 -->
        <div class="stage-right">
          <div class="envelope-area">
            <div class="envelope-hint">这是送给你的专属生日会，请轻轻点开那只信封——</div>
            <button class="envelope-button" id="envelopeButton" aria-label="打开来自未来的信">
              <div class="envelope-glow"></div>
              <div class="envelope-card">
                <div class="envelope-back"></div>
                <div class="envelope-front"></div>
                <div class="envelope-seal">路</div>
                <div class="envelope-label">
                  <span>FROM 2025·12·07</span>
                </div>
              </div>
            </button>
            <div class="small-note">BEST WISHES</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 信件弹窗 -->
    <div class="letter-modal" id="letterModal">
      <div class="letter-card">
        <div class="letter-frame"></div>
        <div class="letter-inner">
          <p class="letter-heading no-indent">Dear Deer：</p>
          <p class="no-indent">见信如晤</p>
          <p class="no-indent">来自2025年12月7日  晴夜  不算太冷</p>

          <p>
            时间过的飞快，距离上一个十二月七已经整整一年了。我想在这个特殊的日子里写点话给你，关于你可能还不知道的事情，也关于你正要迎接的一些日子。
          </p>

          <p>
            一年时间说长也长，说短也短，感觉一年是一眨眼的事，但这一眨眼间我们也做到了很多事。我想对你说，我们当初所做的选择是非常正确的！如今的我们坚持了自己的想法，顺利的收获了很多很多硕果，论文发表了，国奖我们俩都拿到了，读博之路我们也确定了，钱多事儿少老师好，毕业条件也不高。更重要的是我们真的如愿去到了同一所学校，同时也荣升了小金组的做客长老，再也不用开组会啦。此时我们已经算是，人生小满胜万全啦！
          </p>

          <p>
            这一年里，我们依旧在每个平淡却又丰富多彩的日子里互相扶持着成长，偶尔也会吵吵闹闹。但幸运的是，我又经常发自肺腑的感叹，还好有你在，还好我们一起。而更幸运的是，未来无数个年月，无数个十二月七，我依然可以继续感叹，还好有你在，还好我们一起。
          </p>

          <p>
            说完我们，再说一些你自己的事情吧，如今的你正向着你憧憬的方向努力前进，不知不觉中你已经悄悄蜕变了，变得更加坚定，更加勇敢，变得更加独立自信，也更加有力量去顺手解决生活给你出的难题。这是我们都值得骄傲和自豪的事情！恭喜你！成长为了更好的你，也祝福你继续在爱与幸福的包围中成长为更好的你！
          </p>

          <p>
            到此为止，我已经偷偷提前告诉了你很多事情啦，所以请你带着无畏的精神，放心大胆的继续往前冲吧！不止愿你的路上开满鲜花，还愿你路上的荆棘都无法伤到你，而你的内心也会因此更加坚韧，更加强大。
          </p>

          <p>生日快乐！</p>

          <!-- ⭐ 放在信件文字最后的新按钮 -->
          <div style="text-align: right; margin-top: 10px;">
            <button id="magicButton" class="magic-trigger-btn">
              有疑惑？请点击此处
            </button>
          </div>

          <!-- ⭐ 小提示：点击空白处关闭 -->
          <p class="no-indent" style="margin-top: 8px; font-size: 12px; color: #b08b5d; text-align: center;">
            点击空白处关闭
          </p>
        </div>
      </div>
    </div>


    <!-- 魔法对话框 -->
    <div class="magic-dialog" id="magicDialog">
      <p>如果这些听起来像是你已经经历过的，那大概说明，这一年的你真的很棒！</p>
      <p>没错，这封信是写给2024年12月7日的你，也就是说，这封信不仅仅是对你生日的祝福，也是对我们过去一年的总结和对未来一年的展望，同时也是告诉你，无论过去现在还是未来，都要开心，保持幸福，因为我们在彼此的身边，我们就是彼此的底气！</p>
      <div style="text-align: center;">
        <button class="close-btn-dialog" id="closeDialog">收下这份魔法 ✨</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const envelopeButton = document.getElementById("envelopeButton");
      const letterModal = document.getElementById("letterModal");
      const closeLetter = document.getElementById("closeLetter");
      const magicButton = document.getElementById("magicButton");
      const magicDialog = document.getElementById("magicDialog");
      const closeDialog = document.getElementById("closeDialog");
      const starfieldEl = document.getElementById("starfield");
  
      // 粗略判断是否是手机 / 平板，用来做性能优化
      const isLowPowerDevice = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  
      // 控制星空暂停/恢复
      function pauseStars() {
        document.body.classList.add("stars-paused");
      }
  
      function resumeStars() {
        document.body.classList.remove("stars-paused");
      }
  
      // 打开/关闭信件弹窗
      function openLetter() {
        letterModal.classList.add("show");
        createSparkles();
      }
  
      function closeLetterModal() {
        letterModal.classList.remove("show");
      }
  
      // 打开/关闭魔法对话框
      function openMagicDialog() {
        magicDialog.classList.add("show");
        createSparkles();
        launchFireworks(); // 同时放烟花 ✨
      }
  
      function closeMagicDialog() {
        magicDialog.classList.remove("show");
      }
  
      // 事件绑定
      if (envelopeButton) {
        envelopeButton.addEventListener("click", openLetter);
      }
  
      if (closeLetter) {
        closeLetter.addEventListener("click", (e) => {
          e.stopPropagation(); // 防止触发背景点击
          closeLetterModal();
        });
      }
  
      if (magicButton) {
        magicButton.addEventListener("click", (e) => {
          e.stopPropagation();
          openMagicDialog();
        });
      }
  
      if (closeDialog) {
        closeDialog.addEventListener("click", (e) => {
          e.stopPropagation();
          closeMagicDialog();
        });
      }
  
      // 点击遮罩空白处关闭信件
      if (letterModal) {
        letterModal.addEventListener("click", (e) => {
          if (e.target === letterModal) {
            closeLetterModal();
          }
        });
      }
  
      // 小星屑特效
      function createSparkles() {
        const count = isLowPowerDevice ? 10 : 18;
        for (let i = 0; i < count; i++) {
          const spark = document.createElement("div");
          spark.className = "sparkle";
          const angle = Math.random() * Math.PI * 2;
          const radius = 80 + Math.random() * 80;
          const centerX = window.innerWidth / 2;
          const centerY = window.innerHeight / 2;
          const x = centerX + Math.cos(angle) * radius;
          const y = centerY + Math.sin(angle) * radius;
  
          spark.style.position = "fixed";
          spark.style.width = "6px";
          spark.style.height = "6px";
          spark.style.borderRadius = "50%";
          spark.style.background =
            "radial-gradient(circle at 30% 30%, #fff 0, #ffe7b7 50%, rgba(255,255,255,0) 100%)";
          spark.style.pointerEvents = "none";
          spark.style.opacity = "0";
          spark.style.zIndex = "40";
          spark.style.left = x + "px";
          spark.style.top = y + 30 + "px";
          spark.style.animation = "sparkleFloat 1.1s ease-out forwards";
  
          document.body.appendChild(spark);
  
          spark.addEventListener("animationend", () => {
            spark.remove();
          });
        }
      }
  
      // 烟花效果
      function launchFireworks() {
        const count = isLowPowerDevice ? 5 : 12; // 手机只放少量烟花
  
        for (let i = 0; i < count; i++) {
          const fire = document.createElement("div");
          fire.className = "firework";
  
          // 随机位置（中上区域）
          const x = Math.random() * 100; // 0 - 100 vw
          const y = 15 + Math.random() * 50; // 15 - 65 vh
  
          fire.style.left = x + "vw";
          fire.style.top = y + "vh";
  
          // 随机延迟，让烟花错开时间
          fire.style.animationDelay = Math.random() * 0.4 + "s";
  
          document.body.appendChild(fire);
  
          fire.addEventListener("animationend", () => {
            fire.remove();
          });
        }
      }
  
      // 补充小星屑动画 keyframes（保证存在即可）
      const styleSpark = document.createElement("style");
      styleSpark.innerHTML = `
        @keyframes sparkleFloat {
          0% { transform: translate3d(0, 0, 0) scale(0.3); opacity: 0; }
          40% { opacity: 1; }
          100% { transform: translate3d(0, -40px, 0) scale(1); opacity: 0; }
        }
      `;
      document.head.appendChild(styleSpark);
  
      // —— 背景星空：满屏星星 + 部分闪烁 —— //
      function createStarfield() {
        const starfield = starfieldEl;
        if (!starfield) return;
  
        const starCount = 160; // 星星总数不变
        const twinkleCount = isLowPowerDevice ? 32 : 48; // 只有部分星星闪烁
  
        for (let i = 0; i < starCount; i++) {
          const star = document.createElement("div");
          star.className = "star";
  
          // 随机大小（1~3px之间）
          const size = 1 + Math.random() * 2;
          star.style.width = size + "px";
          star.style.height = size + "px";
  
          // 随机位置（0~100%）
          star.style.left = Math.random() * 100 + "%";
          star.style.top = Math.random() * 100 + "%";
  
          if (i < twinkleCount) {
            // 这一部分星星一闪一闪
            star.classList.add("star--twinkle");
            const duration = 3 + Math.random() * 4; // 3~7s 闪烁周期
            const delay = Math.random() * 6; // 0~6s 延迟
            star.style.animationDuration = duration + "s";
            star.style.animationDelay = delay + "s";
          } else {
            // 这些是静态星星，随机亮度当背景
            star.style.opacity = 0.15 + Math.random() * 0.35;
          }
  
          starfield.appendChild(star);
        }
      }
  
      // 现在 DOM 已经 ready，直接创建星空
      createStarfield();
    });
  </script>    
</body>
</html>
